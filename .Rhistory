print(out)
plot(out)
plot.DetectCpObj(out)
out
out$data
out$kernel_ts
out$kernel_epi
out$univariate_ts
devtools::load_all(".")
data_vec <- as.numeric(c(rnorm(50,0,0.1), rnorm(50,1,0.25)))
out <- detect_cp(data = data_vec, n_iterations = 2500, n_burnin = 500,
params = list(a = 1, b = 1, c = 0.1), kernel = "ts")
print(out)
plot(out)
devtools::load_all(".")
out <- clust_cp(data = data_mat, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
params = list(L = 1, gamma = 0.5), B = 10)
library(BayesChange)
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_mat, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
params = list(L = 1, gamma = 0.5), B = 10)
devtools::load_all(".")
out <- clust_cp(data = data_mat, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
params = list(L = 1, gamma = 0.5), B = 10)
devtools::load_all(".")
out <- clust_cp(data = data_mat, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
params = list(L = 1, gamma = 0.5), B = 10)
out <- clust_cp(data = data_mat, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
params = list(phi = 0.1, L = 1, gamma = 0.5), B = 10)
devtools::load_all(".")
devtools::load_all(".")
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_mat, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
params = list(B = 1000, L = 1, gamma = 0.5))
posterior_estimate(out, loss = "binder")
plot(out, loss = "binder")
data_array <- array(data = NA, dim = c(3,100,5))
data_array[1,,1] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[2,,1] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[3,,1] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[1,,2] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[2,,2] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[3,,2] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[1,,3] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_array[2,,3] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_array[3,,3] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_array[1,,4] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_array[2,,4] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_array[3,,4] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_array[1,,5] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
data_array[2,,5] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
data_array[3,,5] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_array, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
list(B = 1000, L = 1, gamma = 0.1, k_0 = 0.25, nu_0 = 5,
phi_0 = diag(0.1,3,3), m_0 = rep(0,3)))
out <- clust_cp(data = data_array, n_iterations = 1000, n_burnin = 100,
kernel = "ts",
list(gamma = 0.1, k_0 = 0.25, nu_0 = 5,  phi_0 = diag(0.1,3,3), m_0 = rep(0,3)))
?clust_cp
out <- clust_cp(data = data_array, n_iterations = 1000, n_burnin = 100,
kernel = "ts", params = list(gamma = 0.1, k_0 = 0.25, nu_0 = 5,  phi_0 = diag(0.1,3,3), m_0 = rep(0,3)))
devtools::load_all(".")
out <- clust_cp(data = data_array, n_iterations = 1000, n_burnin = 100,
kernel = "ts", params = list(gamma = 0.1, k_0 = 0.25, nu_0 = 5,  phi_0 = diag(0.1,3,3), m_0 = rep(0,3)))
posterior_estimate(out, loss = "binder")
plot(out, loss = "binder")
data_mat <- matrix(NA, nrow = 5, ncol = 50)
betas <- list(c(rep(0.45, 25),rep(0.14,25)),
c(rep(0.55, 25),rep(0.11,25)),
c(rep(0.50, 25),rep(0.12,25)),
c(rep(0.52, 10),rep(0.15,40)),
c(rep(0.53, 10),rep(0.13,40)))
inf_times <- list()
for(i in 1:5){
inf_times[[i]] <- sim_epi_data(S0 = 10000, I0 = 10, max_time = 50, beta_vec = betas[[i]], gamma_0 = 1/8)
vec <- rep(0,50)
names(vec) <- as.character(1:50)
for(j in 1:50){
if(as.character(j) %in% names(table(floor(inf_times[[i]])))){
vec[j] = table(floor(inf_times[[i]]))[which(names(table(floor(inf_times[[i]]))) == j)]
}
}
data_mat[i,] <- vec
}
?sim_epi_data
data_mat <- matrix(NA, nrow = 5, ncol = 50)
betas <- list(c(rep(0.45, 25),rep(0.14,25)),
c(rep(0.55, 25),rep(0.11,25)),
c(rep(0.50, 25),rep(0.12,25)),
c(rep(0.52, 10),rep(0.15,40)),
c(rep(0.53, 10),rep(0.13,40)))
inf_times <- list()
for(i in 1:5){
inf_times[[i]] <- sim_epi_data(S0 = 10000, I0 = 10, max_time = 50, beta_vec = betas[[i]], xi_0 = 1/8)
vec <- rep(0,50)
names(vec) <- as.character(1:50)
for(j in 1:50){
if(as.character(j) %in% names(table(floor(inf_times[[i]])))){
vec[j] = table(floor(inf_times[[i]]))[which(names(table(floor(inf_times[[i]]))) == j)]
}
}
data_mat[i,] <- vec
}
out <- clust_cp(data = data_mat, n_iterations = 100, n_burnin = 10,
kernel = "epi",
list(M = 100, B = 1000, L = 1, q = 0.1, gamma = 1/8))
posterior_estimate(out, loss = "binder")
plot(out, loss = "binder")
devtools::load_all(".")
devtools::check(remote = TRUE, manual = TRUE)
devtools::load_all(".")
devtools::check(remote = TRUE, manual = TRUE)
remove.packages("BayesChange")
devtools::load_all(".")
data_mat <- matrix(NA, nrow = 100, ncol = 1)
betas <- c(rep(0.45, 25),rep(0.14,75))
inf_times <- sim_epi_data(10000, 10, 100, betas, 1/8)
inf_times_vec <- rep(0,100)
names(inf_times_vec) <- as.character(1:100)
for(j in 1:100){
if(as.character(j) %in% names(table(floor(inf_times)))){
inf_times_vec[j] = table(floor(inf_times))[which(names(table(floor(inf_times))) == j)]
}
}
data_mat[,1] <- inf_times_vec
out <- detect_cp(data = data_mat, n_iterations = 500, n_burnin = 100,
params = list(M = 250, xi = 1/8, a0 = 40, b0 = 10), kernel = "epi")
print(out)
x <- out
est_cp = posterior_estimate(x, loss = loss, maxNClusters = maxNClusters,
nRuns = nRuns, maxZealousAttempts = maxZealousAttempts)
loss = "binder"
est_cp = posterior_estimate(x, loss = loss, maxNClusters)
loss = "binder"
est_cp = posterior_estimate(x, loss = loss)
cp <- cumsum(table(est_cp))[-length(table(est_cp))]
cp
x <- out
est_cp = posterior_estimate(x, loss = "binder")
est_cp
data_array <- array(data = NA, dim = c(3,100,5))
data_array[1,,1] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[2,,1] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[3,,1] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[1,,2] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[2,,2] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[3,,2] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_array[1,,3] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_array[2,,3] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_array[3,,3] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_array[1,,4] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_array[2,,4] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_array[3,,4] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
#'
data_array[1,,5] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
data_array[2,,5] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
data_array[3,,5] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_array, n_iterations = 3000, n_burnin = 1000,
params = list(phi = 0.5, k_0 = 0.25,
nu_0 = 5, S_0 = diag(0.1,3,3),
m_0 = rep(0,3)), B = 1000,  kernel = "ts")
print(out)
x <- out
est_cp = posterior_estimate(x, loss = "binder")
est_cp
.data_plot <- data.frame(Value = numeric(0))
count = 0
for (i in 1:dim(x$data)[3]) {
mat <- x$data[,,i]
for(j in 1:nrow(mat)){
count = count + 1
.data_plot <- rbind(.data_plot, data.frame(Value = as.vector(mat[j,]),
Observation = i,
Cluster = est_cp[i],
Time = 1:ncol(mat),
Count = count))
}
}
.data_plot$Observation <- as.factor(.data_plot$Observation)
.data_plot$Cluster <- as.factor(.data_plot$Cluster)
.data_plot$Count <- as.factor(.data_plot$Count)
ggplot2::ggplot(.data_plot) +
ggplot2::geom_line(ggplot2::aes(x = Time, y = Value, color = Observation, group = Count, linetype = Cluster)) +
ggplot2::xlab("Time") +
ggplot2::ylab("Value") +
ggplot2::scale_colour_brewer(palette = "Set1") +
ggplot2::theme_minimal()
.data_plot
remove.packages("BayesChange")
library(BayesChange)
data_vec <- as.numeric(c(rnorm(50,0,0.1), rnorm(50,1,0.25)))
out <- detect_cp(data = data_vec, n_iterations = 2500, n_burnin = 500,
params = list(a = 1, b = 1, c = 0.1), kernel = "ts")
devtools::load_all(".")
data_vec <- as.numeric(c(rnorm(50,0,0.1), rnorm(50,1,0.25)))
out <- detect_cp(data = data_vec, n_iterations = 2500, n_burnin = 500,
params = list(a = 1, b = 1, c = 0.1), kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_mat, n_iterations = 5000, n_burnin = 1000,
L = 1, params = list(phi = 0.5), B = 1000, kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
out <- clust_cp(data = data_mat, n_iterations = 5000, n_burnin = 1000,
L = 1, params = list(phi = 0.1), B = 1000, kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
out <- clust_cp(data = data_mat, n_iterations = 5000, n_burnin = 1000,
L = 1, params = list(phi = 0.9), B = 1000, kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
?detect_cp
data_vec <- as.numeric(c(rnorm(50,0,0.1), rnorm(50,1,0.25)))
out <- detect_cp(data = data_vec, n_iterations = 2500, n_burnin = 500,
params = list(a = 1, b = 1, c = 0.1), kernel = "ts")
print(out)
data_vec <- as.numeric(c(rnorm(50,0,0.1), rnorm(50,1,0.25)))
out <- detect_cp(data = data_vec, n_iterations = 2500, n_burnin = 500,
params = list(a = 1, b = 1, c = 0.1), kernel = "ts")
summary(out)
posterior_estimate(out)
plot(out)
data_mat <- matrix(NA, nrow = 3, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
out <- detect_cp(data = data_mat, n_iterations = 2500, n_burnin = 500,
params = list(m_0 = rep(0,3), k_0 = 0.25, nu_0 = 4,
S_0 = diag(1,3,3)), kernel = "ts")
summary(out)
posterior_estimate(out)
plot(out)
data_mat <- matrix(NA, nrow = 100, ncol = 1)
betas <- c(rep(0.45, 25),rep(0.14,75))
inf_times <- sim_epi_data(10000, 10, 100, betas, 1/8)
inf_times_vec <- rep(0,100)
names(inf_times_vec) <- as.character(1:100)
for(j in 1:100){
if(as.character(j) %in% names(table(floor(inf_times)))){
inf_times_vec[j] = table(floor(inf_times))[which(names(table(floor(inf_times))) == j)]
}
}
data_mat[,1] <- inf_times_vec
out <- detect_cp(data = data_mat, n_iterations = 500, n_burnin = 100,
params = list(M = 250, xi = 1/8, a0 = 40, b0 = 10), kernel = "epi")
summary(out)
posterior_estimate(out)
plot(out)
?clust_cp
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_mat, n_iterations = 5000, n_burnin = 1000,
L = 1, params = list(phi = 0.5), B = 1000, kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_mat, n_iterations = 5000, n_burnin = 1000,
L = 1, params = list(phi = 0.5), B = 1000, kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
devtools::load_all(".")
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
out <- clust_cp(data = data_mat, n_iterations = 5000, n_burnin = 1000,
L = 1, params = list(phi = 0.5), B = 1000, kernel = "ts")
print(out)
summary(out)
posterior_estimate(out)
plot(out)
summary(out)
posterior_estimate(out)
plot(out)
usethis::use_version("patch")
devtools::submit_cran()
devtools::load_all(".")
devtools::submit_cran()
devtools::load_all(".")
devtools::check()
devtools::build()
devtools::submit_cran()
install.packages(c("arrow", "bayesplot", "BiocManager", "BNPmix", "boot", "broom", "checkmate", "colorspace", "commonmark", "cowplot", "credentials", "crosstalk", "curl", "data.table", "dbplyr", "DEoptimR", "Deriv", "devtools", "doBy", "dtplyr", "evaluate", "fields", "forcats", "gargle", "ggfun", "ggimage", "ggm", "ggnewscale", "ggplot2", "ggplotify", "ggpubr", "ggridges", "ggsci", "glmnet", "googledrive", "googlesheets4", "here", "hexSticker", "hms", "httr2", "igraph", "later", "leaflet", "litedown", "magick", "magrittr", "Matrix", "mclust", "openssl", "packrat", "patchwork", "pbkrtest", "pillar", "pkgload", "PKI", "pracma", "promises", "purrr", "QuickJSR", "R2WinBUGS", "ragg", "Rcpp", "RcppArmadillo", "RcppDist", "RcppParallel", "reformulas", "renv", "rmarkdown", "robustbase", "roxygen2", "rprojroot", "rsconnect", "rstatix", "rversions", "rvest", "salso", "sfsmisc", "shiny", "stringr", "systemfonts", "terra", "textshaping", "tibble", "units", "usethis", "utf8", "vroom", "waldo", "xfun", "xml2", "yulab.utils"))
devtools::load_all(".")
usethis::use_version()
usethis::use_version()
devtools::build()
?BayesChange::detect_cp
library("BayesChange")
library("ggplot2")
set.seed(241025)
########################
# Detect Change Points #
########################
## Univariate data
data <- as.numeric()
data[1] <- rnorm(1, mean = 0, sd = 0.13)
for(i in 2:50){
data[i] <- 0.1 * data[i-1] + (1 - 0.1) * 0 +
rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.13)
}
data[51] <- rnorm(1, mean = 1.5, sd = 0.15)
for(i in 52:150){
data[i] <- 0.1 * data[i-1] + (1 - 0.1) * 1.5 +
rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.15)
}
data[151] <- rnorm(1, mean = 0, sd = 0.12)
for(i in 152:200){
data[i] <- 0.1 * data[i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.12)
}
params_uni <- list(a = 1, b = 1, c = 1, prior_var_phi = 0.1,
prior_delta_c = 1, prior_delta_d = 1)
out <- detect_cp(data = data, n_iterations = 10000, n_burnin = 5000,
q = 0.25, params = params_uni, kernel = "ts")
print(out)
cp_est <- posterior_estimate(out, loss = "binder")
cumsum(table(cp_est))[-length(table(cp_est))] + 1
# plot
plot(x = out, loss = "binder", plot_freq = TRUE)
data <- matrix(NA, nrow = 3, ncol = 200)
data[1, 1] <- rnorm(1, mean = 1.20, sd = 0.12)
data[2, 1] <- rnorm(1, mean = 1.15, sd = 0.15)
data[3, 1] <- rnorm(1, mean = 1.10, sd = 0.14)
for(i in 2:50){
data[1, i] <- 0.1 * data[1, i-1] + (1 - 0.1) * 1.20 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.12)
data[2, i] <- 0.1 * data[2, i-1] + (1 - 0.1) * 1.15 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.15)
data[3, i] <- 0.1 * data[3, i-1] + (1 - 0.1) * 1.10 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.14)
}
data[1, 51] <- rnorm(1, mean = 0.06, sd = 0.14)
data[2, 51] <- rnorm(1, mean = 0.07, sd = 0.12)
data[3, 51] <- rnorm(1 ,mean = 0.08, sd = 0.10)
for(i in 52:150){
data[1, i] <- 0.1 * data[1, i-1] + (1 - 0.1) * 0.06 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.14)
data[2, i] <- 0.1 * data[2, i-1] + (1 - 0.1) * 0.07 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.12)
data[3, i] <- 0.1 * data[3, i-1] + (1 - 0.1) * 0.08 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.10)
}
data[1, 151] <- rnorm(1, mean = 0.72, sd = 0.13)
data[2, 151] <- rnorm(1, mean = 0.69, sd = 0.10)
data[3, 151] <- rnorm(1, mean = 0.75, sd = 0.14)
for(i in 152:200){
data[1, i] <- 0.1 * data[1, i-1] + (1 - 0.1) * 0.72 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.13)
data[2, i] <- 0.1 * data[2, i-1] + (1 - 0.1) * 0.69 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.10)
data[3, i] <- 0.1 * data[3, i-1] + (1 - 0.1) * 0.75 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.14)
}
params_multi <- list(m_0 = rep(0,3),
k_0 = 1,
nu_0 = 10,
S_0 = diag(0.15,3,3),
prior_var_phi = 0.1,
prior_delta_c = 1,
prior_delta_d = 1)
out <- detect_cp(data = data, n_iterations = 10000, n_burnin = 5000, q = 0.5,
params = params_multi, kernel = "ts")
est_cp <- posterior_estimate(out, loss = "binder")
cumsum(table(est_cp))[-length(table(est_cp))] + 1
# plot
plot(out, loss = "binder", plot_freq = TRUE)
# Univariate
data <- matrix(NA, nrow = 5, ncol = 200)
data[1, 1] <- rnorm(n = 1, mean = 0, sd = 0.100)
data[2, 1] <- rnorm(n = 1, mean = 0, sd = 0.125)
data[3, 1] <- rnorm(n = 1, mean = 0, sd = 0.175)
for(i in 2:50){
data[1, i] <- 0.1 * data[1, i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.100)
data[2, i] <- 0.1 * data[2, i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.125)
data[3, i] <- 0.1 * data[3, i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.110)
}
data[1, 51] <- rnorm(1, mean = 1, sd = 0.230)
data[2, 51] <- rnorm(1, mean = 1, sd = 0.225)
data[3, 51] <- rnorm(1, mean = 1, sd = 0.240)
for(i in 52:150){
data[1, i] <- 0.1 * data[1, i-1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.230)
data[2, i] <- 0.1 * data[2, i-1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.225)
data[3, i] <- 0.1 * data[3, i-1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.240)
}
data[1, 151] <- rnorm(1, mean = 0.5, sd = 0.225)
data[2, 151] <- rnorm(1, mean = 0.5, sd = 0.235)
data[3, 151] <- rnorm(1, mean = 0.5, sd = 0.100)
for(i in 152:200){
data[1, i] <- 0.1 * data[1, i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.225)
data[2, i] <- 0.1 * data[2, i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.235)
data[3, i] <- 0.1 * data[3, i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.100)
}
data[4, 1] <- rnorm(1, mean = 0, sd = 0.135)
data[5, 1] <- rnorm(1, mean = 0, sd = 0.155)
for(i in 2:25){
data[4, i] <- 0.1 * data[4,i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.135)
data[5, i] <- 0.1 * data[5,i-1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.155)
}
data[4, 26] <- rnorm(1, mean = 1, sd = 0.165)
data[5, 26] <- rnorm(1, mean = 1, sd = 0.185)
for(i in 27:200){
data[4, i] <- 0.1 * data[4, i-1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.165)
data[5, i] <- 0.1 * data[5, i-1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.185)
}
params_uni <- list(a = 0.1,
b = 1,
c = 1,
phi = 0.1)
out <- clust_cp(data = data, n_iterations = 5000, n_burnin = 2000,
L = 1, q = 0.5, B = 10000, params = params_uni, kernel = "ts")
print(out)
posterior_estimate(out, loss = "binder")
# plot
plot(out, loss = "binder")
data <- array(data = NA, dim = c(2, 200, 5))
data[1:2,1,1] <- rnorm(1 ,mean = 0, sd = 0.100)
data[1:2,1,2] <- rnorm(1, mean = 0, sd = 0.125)
data[1:2,1,3] <- rnorm(1, mean = 0, sd = 0.175)
for(i in 2:50){
data[1, i, 1] <- 0.1 * data[1, i-1, 1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.100)
data[2, i, 1] <- 0.1 * data[2, i-1, 1] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.100)
data[1, i, 2] <- 0.1 * data[1, i-1, 2] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.125)
data[2, i, 2] <- 0.1 * data[2, i-1, 2] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.125)
data[1, i, 3] <- 0.1 * data[1, i-1, 3] + (1 - 0.1) * 0 + rnorm(1 ,mean = 0, sd = (1 - 0.1^2) * 0.110)
data[2, i, 3] <- 0.1 * data[2, i-1, 3] + (1 - 0.1) * 0 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.110)
}
data[1, 51, 1] <- data[2, 51, 1] <- rnorm(1, mean = 1, sd = 0.230)
data[1, 51, 2] <- data[2, 51, 2] <- rnorm(1, mean = 1, sd = 0.225)
data[1, 51, 3] <- data[2, 51, 3] <- rnorm(1, mean = 1, sd = 0.240)
for(i in 52:150){
data[1, i, 1] <- 0.1 * data[1, i-1, 1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.230)
data[2, i, 1] <- 0.1 * data[2, i-1, 1] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.230)
data[1, i, 2] <- 0.1 * data[1, i-1, 2] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.225)
data[2, i, 2] <- 0.1 * data[2, i-1, 2] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.225)
data[1, i, 3] <- 0.1 * data[1, i-1, 3] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.240)
data[2, i, 3] <- 0.1 * data[2, i-1, 3] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.240)
}
data[1:2, 151, 1] <- rnorm(2, mean = 0.5, sd = 0.225)
data[1:2, 151, 2] <- rnorm(2, mean = 0.5, sd = 0.235)
data[1:2, 151, 3] <- rnorm(2, mean = 0.5, sd = 0.100)
for(i in 152:200){
data[1, i, 1] <- 0.1 * data[1, i-1, 1] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.225)
data[2, i, 1] <- 0.1 * data[2, i-1, 1] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.225)
data[1, i, 2] <- 0.1 * data[1, i-1, 2] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.235)
data[2, i, 2] <- 0.1 * data[2, i-1, 2] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.235)
data[1, i, 3] <- 0.1 * data[1, i-1, 3] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.100)
data[2, i, 3] <- 0.1 * data[2, i-1, 3] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.100)
}
data[1:2,1,4] <- rnorm(1, mean = 1, sd = 0.135)
data[1:2,1,5] <- rnorm(1, mean = 1, sd = 0.155)
for(i in 2:25){
data[1, i, 4] <- 0.1 * data[1, i-1, 4] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.135)
data[2, i, 4] <- 0.1 * data[2, i-1, 4] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.135)
data[1, i, 5] <- 0.1 * data[1, i-1, 5] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.155)
data[2, i, 5] <- 0.1 * data[2, i-1, 5] + (1 - 0.1) * 1 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.155)
}
data[1:2, 26, 4] <- rnorm(n = 1, mean = 0.5, sd = 0.165)
data[1:2, 26, 5] <- rnorm(n = 1, mean = 0.5, sd = 0.185)
for(i in 27:200){
data[1, i, 4] <- 0.1 * data[1, i-1, 4] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.165)
data[2, i, 4] <- 0.1 * data[2, i-1, 4] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.165)
data[1, i, 5] <- 0.1 * data[1, i-1, 5] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.185)
data[2, i, 5] <- 0.1 * data[2, i-1, 5] + (1 - 0.1) * 0.5 + rnorm(1, mean = 0, sd = (1 - 0.1^2) * 0.185)
}
params_multi <- list(m_0 = rep(0,2),
k_0 = 1,
nu_0 = 5,
S_0 = diag(1,2,2),
phi = 0.1)
out <- clust_cp(data = data, n_iterations = 10000, n_burnin = 5000,
L = 1, B = 10000, params = params_multi, kernel = "ts")
print(out)
posterior_estimate(out, loss = "binder")
# plot
plot(out, loss = "binder")
